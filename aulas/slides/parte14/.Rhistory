library(kableExtra)
aa <- expand.grid(1:5,1:5,1:5)
xx <- c(1,0,1,0,1)
phat <- unlist(apply(aa,1,function(x) mean(xx[x])))
aa$phat <- round(phat,3)
5*5*5
125/2
library(ggplot2)
?stat_function
?rbinom
N=1000000
n=10
xx <- rbinom(N,1,0.6)
N=1000000
n=10
xx <- rbinom(N,1,0.6)
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
ff <- as.data.frame(table(aa$phat))
ff$Prop=round(ff$Freq/(sum(ff$Freq)),3)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = .003),
colour = "black",
fill = "blue") +  geom_vline(xintercept=0.6, color="red") +
stat_function(fun = dnorm, args = list(mean = 0.6, sd = sqrt(0.6*.4/n)),col="red") + xlab(" ") + ylab(" ")
N=1000000
n=10
xx <- rbinom(n=N,size=1,prob=0.6)
mean(xx)
xx
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
View(bb)
ff <- as.data.frame(table(aa$phat))
ff
ff$Prop=round(ff$Freq/(sum(ff$Freq)),3)
ff
hist(aa$phat)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = .03),
colour = "black",
fill = "blue") +  geom_vline(xintercept=0.6, color="red") +
stat_function(fun = dnorm, args = list(mean = 0.6, sd = sqrt(0.6*.4/n)),col="red") + xlab(" ") + ylab(" ") + ylim(0,30)+xlim(0.4,0.8)
1000+2000+3000+4000+5000
((1000-3000)^2)+((2000-3000)^2)+((4000-3000)^2)+((5000-3000)^2)
(((1000-3000)^2)+((2000-3000)^2)+((4000-3000)^2)+((5000-3000)^2))/5
sqrt(2000000)
barplot(c(1000,2000,3000,4000,5000), col="blue", main="",
cex.lab=1.0, cex.axis=1.0, cex.names=1.0, cex.main=2, las=2)
namess <- c("1000","2000","3000","4000","5000")
barplot(c(rep(1/5,5)), names.arg=namess, col="blue", main="",
cex.lab=1.0, cex.axis=1.0, cex.names=1.0, cex.main=2, las=2)
xx <- c(1000,2000,3000,4000,5000)
mean(xx)
var(xx)
var(xx)*5/4
var(xx)*4/5
library(kableExtra)
aa <- expand.grid(1:5,1:5)
xx <- c(1000,2000,3000,4000,5000)
phat <- unlist(apply(aa,1,function(x) mean(xx[x])))
aa$phat <- phat
kable(aa,align = 'ccc',col.names = c("Primeira pessoa","Segunda pessoa","$\\bar{X}$"))
ff <- as.data.frame(table(aa$phat))
ff$Prop=ff$Freq/(sum(ff$Freq))
kable(ff[,c(1,3)],align = 'cc',col.names = c("$x$","$P(\\bar{X}=x)$"))
esp <- sum(ff$Freq*ff$Prop)
ff <- as.data.frame(table(aa$phat))
ff$Prop=ff$Freq/(sum(ff$Freq))
kable(ff[,c(1,3)],align = 'cc',col.names = c("$x$","$P(\\bar{X}=x)$"))
esp <- sum(ff$Freq*ff$Prop)
esp <- sum(as.numeric(as.character(ff$Var1))*ff$Prop)
vari <- sum( ((as.numeric(as.character(ff$Var1)) - esp )^2)*ff$Prop)
1000000/5
N=1000000
n=1000
xx <- c(rep(1000,N/5),rep(2000,N/5),rep(3000,N/5),rep(4000,N/5),rep(5000,N/5))
mu=mean(xx)
vari = var(xx) * (N-1)/N
N=1000000
n=100
xx <- c(rep(1000,N/5),rep(2000,N/5),rep(3000,N/5),rep(4000,N/5),rep(5000,N/5))
mu=mean(xx)
vari = var(xx) * (N-1)/N
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
ff <- as.data.frame(table(aa$phat))
ff$Prop=round(ff$Freq/(sum(ff$Freq)),3)
ff
library(ggplot2)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = .01),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red")
N=1000000
n=100
xx <- c(rep(1000,N/5),rep(2000,N/5),rep(3000,N/5),rep(4000,N/5),rep(5000,N/5))
mu=mean(xx)
vari = var(xx) * (N-1)/N
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
library(ggplot2)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red")
library(ggplot2)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red") + xlab(" ") + ylab(" ") + ylim(0,0.005) + xlim(2400,3600)
N=1000000
n=1000
xx <- c(rep(1000,N/5),rep(2000,N/5),rep(3000,N/5),rep(4000,N/5),rep(5000,N/5))
mu=mean(xx)
vari = var(xx) * (N-1)/N
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
hist(aa$phat)
df <- data.frame(PF = aa$phat)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red") + xlab(" ") + ylab(" ") + ylim(0,0.005) + xlim(2400,3600)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 1),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red") + xlab(" ") + ylab(" ") + ylim(0,0.005) + xlim(2400,3600)
boxplot(aa$phat)
hist(aa$phat)
min(aa$phat)
max(aa$phat)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 5),
colour = "black",
fill = "blue")
df <- data.frame(PF = aa$phat)
g <- ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 5),
colour = "black",
fill = "blue")
g
g +  geom_vline(xintercept=mu, color="red")
g +  geom_vline(xintercept=mu, color="red") + stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red")
1000*1000/12
83333.33/2
1000*1000/12
4000*4000/12
1333333/2
1333333/2
?runif
N=1000000
n=100
xx <- runif(N,min=1000,max=5000)
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
hist(aa$phat)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red") + xlab(" ") + ylab(" ") + ylim(0,30)+xlim(2000,4000)
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red")
n
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 5),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red")
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red")
N=1000000
n=100
xx <- runif(N,min=1000,max=5000)
mean(xx)
var(xx)
((5000-1000)^2)/12
N=1000000
n=100
xx <- runif(N,min=1000,max=5000)
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
mu=mean(xx)
vari = var(xx) * (N-1)/N
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red")
cc <- c(1000,2000,3000,4000,5000)
var(cc)*5/4
var(cc)
mean(cc)
var(cc)
var(cc)*4/5
N=1000000
n=1000
xx <- rbinom(N,1,0.6)
B=100000
bb <- matrix(NA,nrow=B,ncol=n)
for (i in 1:B)
{
bb[i,] <- sample(1:N,n,replace=TRUE)
}
phat <- unlist(apply(bb,1,function(x) mean(xx[x])))
aa <- data.frame(bb)
aa$phat <- round(phat,3)
mu=mean(xx)
vari = var(xx) * (N-1)/N
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red") +
stat_function(fun = dnorm, args = list(mean = mu, sd = sqrt(vari/n)),col="red")
df <- data.frame(PF = aa$phat)
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue") +  geom_vline(xintercept=mu, color="red")
mu
df <- data.frame(PF = runif(1000000,min=1000,max=5000))
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(min(aa$phat), max(aa$phat), by = 10),
colour = "black",
fill = "blue")
df <- data.frame(PF = runif(1000000,min=1000,max=5000))
ggplot(df, aes(x = PF)) +
geom_histogram(aes(y =..density..),
breaks = seq(1000, 5000, by = 10),
colour = "black",
fill = "blue")
